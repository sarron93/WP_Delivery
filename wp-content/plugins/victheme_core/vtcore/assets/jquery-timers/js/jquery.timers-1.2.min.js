jQuery.fn.extend({everyTime:function(e,t,i,n){return this.each(function(){jQuery.timer.add(this,e,t,i,n)})},oneTime:function(e,t,i){return this.each(function(){jQuery.timer.add(this,e,t,i,1)})},stopTime:function(e,t){return this.each(function(){jQuery.timer.remove(this,e,t)})}}),jQuery.extend({timer:{global:[],guid:1,dataKey:"jQuery.timer",regex:/^([0-9]+(?:\.[0-9]*)?)\s*(.*s)?$/,powers:{ms:1,cs:10,ds:100,s:1e3,das:1e4,hs:1e5,ks:1e6},timeParse:function(e){if(void 0==e||null==e)return null;var t=this.regex.exec(jQuery.trim(e.toString()));if(t[2]){var i=parseFloat(t[1]),n=this.powers[t[2]]||1;return i*n}return e},add:function(e,t,i,n,a){var s=0;if(jQuery.isFunction(i)&&(a||(a=n),n=i,i=t),t=jQuery.timer.timeParse(t),!("number"!=typeof t||isNaN(t)||0>t)){("number"!=typeof a||isNaN(a)||0>a)&&(a=0),a=a||0;var o=jQuery.data(e,this.dataKey)||jQuery.data(e,this.dataKey,{});o[i]||(o[i]={}),n.timerID=n.timerID||this.guid++;var r=function(){(++s>a&&0!==a||n.call(e,s)===!1)&&jQuery.timer.remove(e,i,n)};r.timerID=n.timerID,o[i][n.timerID]||(o[i][n.timerID]=window.setInterval(r,t)),this.global.push(e)}},remove:function(e,t,i){var n,a=jQuery.data(e,this.dataKey);if(a){if(t){if(a[t]){if(i)i.timerID&&(window.clearInterval(a[t][i.timerID]),delete a[t][i.timerID]);else for(var i in a[t])window.clearInterval(a[t][i]),delete a[t][i];for(n in a[t])break;n||(n=null,delete a[t])}}else for(t in a)this.remove(e,t,i);for(n in a)break;n||jQuery.removeData(e,this.dataKey)}}}}),jQuery(window).bind("unload",function(){jQuery.each(jQuery.timer.global,function(e,t){jQuery.timer.remove(t)})});